Decouple publisher from queues

Enable consumer to define queue strategy to distribute workload

